@attribute [Authorize]
@page "/Account/Logs"
@inject IHttpContextAccessor HttpContextAccessor

<PageTitle>Hesap > Olay Günlükleri | Merchanter</PageTitle>

<FluentLabel Typo="Typography.H1"><FluentIcon Value="@(new Microsoft.FluentUI.AspNetCore.Components.Icons.Regular.Size28.ReadingList())" />&nbsp;Olay Günlükleri</FluentLabel>
<FluentLayout Orientation="Orientation.Vertical" Style="padding-top:10px;">
    @if (HttpContextAccessor?.HttpContext?.User.Identity != null && HttpContextAccessor.HttpContext.User.Identity.IsAuthenticated) {
        <LogListComponent customer_id="@customer_id" />
    }
    else {
        <FluentLabel>Olay günlükleri sayfasına erişim izniniz yok.</FluentLabel>
    }
</FluentLayout>

@code {
    public int customer_id { get; set; }

    protected override void OnInitialized() {
        if (int.TryParse(HttpContextAccessor.HttpContext?.User.Claims.FirstOrDefault(x => x.Type == Variables.customer_id)?.Value, out int CID)) {
            customer_id = CID;
        }
    }
}
